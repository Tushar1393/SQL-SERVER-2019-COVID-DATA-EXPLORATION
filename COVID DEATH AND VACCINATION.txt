- CREATE DATABASE PROJECTS


-SELECT * FROM PROJECTS..[COVID DEATHS ]
WHERE CONTINENT IS NOT NULL 
ORDER BY 'DATE' , 'TOTAL_CASES'


-SELECT * FROM PROJECTS..[COVID VACCINATION] 
ORDER BY 'DATE' , 'NEW_TESTS'


- SELECTING THE REQUIRED DATA.

SELECT LOCATION, DATE,NEW_CASES, TOTAL_CASES , TOTAL_DEATHS, POPULATION 
FROM 
PROJECTS..[COVID DEATHS ]
ORDER BY 1,2


- TOTAL CASES VS TOTOL DEATH AS PER COUNTRY

SELECT LOCATION, COUNT ( TOTAL_CASES) AS TOTALCASES_COUNT, COUNT(TOTAL_DEATHS) AS TOTALDEATHS_COUNT
FROM PROJECTS..[COVID DEATHS ]
GROUP BY LOCATION


- % OF PEOPLE WHO DIED DUE TO COIVD

SELECT LOCATION, DATE, TOTAL_CASES , TOTAL_DEATHS, (TOTAL_DEATHS/TOTAL_CASES)*100 AS DEATHS_PERCENTAGE
FROM 
PROJECTS..[COVID DEATHS ]
ORDER BY 1,2


- PERCENTAGE OF INDIA FOR COVID DEATHS. AND ALSO THIS INDICATEDS LIKLIHOOD OF DYING IF YOU CINTRACTED COVID IN INDIA

SELECT LOCATION, DATE, TOTAL_CASES , TOTAL_DEATHS, (TOTAL_DEATHS/TOTAL_CASES)*100 AS DEATHS_PERCENTAGE
FROM 
PROJECTS..[COVID DEATHS ]
WHERE LOCATION LIKE '%INDIA%'
ORDER BY 1,2


- HIGHEST PERCENTAGE OF DEATH RATE OVERALL AS PER LOCATION AND DATE

SELECT LOCATION, DATE, TOTAL_CASES , TOTAL_DEATHS, (TOTAL_DEATHS/TOTAL_CASES)*100 AS DEATHS_PERCENTAGE
FROM 
PROJECTS..[COVID DEATHS ]
ORDER BY 5 DESC


- HIGHEST INFECTION COUNT AS PER THE COUNTRY.

SELECT LOCATION, POPULATION, MAX(TOTAL_CASES) AS HIGHEST_INFECTION_COUNT,
MAX((TOTAL_CASES/POPULATION))*100 AS PERCENTAGE_POPU_INFECTED
FROM
PROJECTS..[COVID DEATHS ]
GROUP BY LOCATION, POPULATION
ORDER BY PERCENTAGE_POPU_INFECTED


- INFECTED POPULATION PERCETANGE OF INDIA  

SELECT LOCATION, POPULATION, MAX(TOTAL_CASES) AS HIGHEST_INFECTION_COUNT,
MAX((TOTAL_CASES/POPULATION))*100 AS PERCENTAGE_POPU_INFECTED
FROM
PROJECTS..[COVID DEATHS ]
WHERE LOCATION LIKE '%INDIA%'
GROUP BY LOCATION, POPULATION
ORDER BY 1


- TOTAL CASES VS POPULATION 

SELECT LOCATION, TOTAL_CASES, POPULATION, (TOTAL_CASES/POPULATION)* 100 AS CASES_ON_POPULATION 
FROM 
PROJECTS..[COVID DEATHS ]
WHERE LOCATION LIKE '%INDIA%'
ORDER BY 2 


- COUNTRIES WITH HIGHEST DEATH COUNT AS PER THE POPULATION 

SELECT LOCATION, MAX(CAST(TOTAL_DEATHS AS INT)) AS MAX_DEATHS
FROM
PROJECTS..[COVID DEATHS ]
WHERE CONTINENT IS NOT NULL 
GROUP BY LOCATION
ORDER BY MAX_DEATHS DESC 



- CONTINENT MOST DEATH  

SELECT CONTINENT, MAX(CAST(TOTAL_DEATHS AS INT)) AS MAX_DEATHS
FROM
PROJECTS..[COVID DEATHS ]
WHERE CONTINENT IS NOT NULL 
GROUP BY CONTINENT
ORDER BY MAX_DEATHS DESC 


- GLOBAL COUNT

SELECT  DATE,SUM(CAST(NEW_CASES AS INT)) AS DAY_COUNT 
FROM 
PROJECTS..[COVID DEATHS ]
WHERE CONTINENT IS NOT NULL
GROUP BY DATE 
ORDER BY 1


- DEATH PERTANGE WORLDWIDE 

SELECT DATE , SUM(NEW_CASES) AS TOT_CASES, SUM(CAST(NEW_DEATHS AS INT)) AS TOT_DEATHS, 
SUM(CAST(NEW_DEATHS AS INT))/SUM(NEW_CASES) * 100 AS DEATH_PERCENTANGE_NEW 
FROM 
PROJECTS..[COVID DEATHS ]
WHERE CONTINENT IS NOT NULL
GROUP BY DATE 
ORDER BY 1


-- TOTAL NUMBERS 

SELECT SUM(NEW_CASES) AS TOT_CASES, SUM(CAST(NEW_DEATHS AS INT)) AS TOT_DEATHS, 
SUM(CAST(NEW_DEATHS AS INT))/SUM(NEW_CASES) * 100 AS DEATH_PERCENTANGE_NEW 
FROM 
PROJECTS..[COVID DEATHS ]
WHERE CONTINENT IS NOT NULL 
ORDER BY 1



-- COVID VACCINATON 

SELECT * FROM PROJECTS..[COVID VACCINATION]
ORDER BY 4 



-- JOIN COVID DEATH AND VACCINATION TABLES

SELECT * FROM 
PROJECTS..[COVID DEATHS ] DEATH INNER JOIN 
PROJECTS..[COVID VACCINATION] VAC
ON DEATH.DATE = VAC.DATE AND
DEATH.LOCATION = VAC.LOCATION 


-- POPULATION VS VACCINATION
CALCULATED THE TOTAL VACCINATION BY LOCATION AND OUTPUT IT AS ROLLING COUNT TO NEXT DAY AND SO ON TO GET THE TOTAL COUNT ON VACCINATION 
WITH THE HELP OF TEMP TABLE  


DROP TABLE IF EXISTS #POPULATIONVACCINATED /* ADDED TO AVOIDE FRQ ERROR WHILE RE RUNNING THE QUERY */
CREATE TABLE #POPULATIONVACCINATED 
(
CONTINENT NVARCHAR(255),
LOCATION NVARCHAR(255),
DATE DATETIME,
POPULATION NUMERIC,
NEW_VACCINATIONS NUMERIC,
ROLLING_COUNT NUMERIC 
)
 

INSERT INTO #POPULATIONVACCINATED

SELECT DEATH.CONTINENT, DEATH.LOCATION, DEATH.DATE, DEATH.POPULATION, VAC.NEW_VACCINATIONS,
SUM(CAST(VAC.NEW_VACCINATIONS AS BIGINT)) OVER (PARTITION BY 
DEATH.LOCATION ORDER BY DEATH.LOCATION, DEATH.DATE) AS ROLLING_COUNT  
FROM 
PROJECTS..[COVID DEATHS ] DEATH  JOIN  PROJECTS..[COVID VACCINATION] VAC 
ON DEATH.LOCATION = VAC.LOCATION AND DEATH.DATE = VAC.DATE  


SELECT *, (ROLLING_COUNT/POPULATION)*100 
FROM #POPULATIONVACCINATED



- VIEW FOR VISULATIOZATION 

CREATE VIEW POPULATIONVACCINATED 
AS 
SELECT DEATH.CONTINENT, DEATH.LOCATION, DEATH.DATE, DEATH.POPULATION, VAC.NEW_VACCINATIONS,
SUM(CAST(VAC.NEW_VACCINATIONS AS BIGINT)) OVER (PARTITION BY 
DEATH.LOCATION ORDER BY DEATH.LOCATION, DEATH.DATE) AS ROLLING_COUNT  
FROM 
PROJECTS..[COVID DEATHS ] DEATH  JOIN  PROJECTS..[COVID VACCINATION] VAC 
ON DEATH.LOCATION = VAC.LOCATION AND DEATH.DATE = VAC.DATE 
WHERE DEATH.CONTINENT IS NOT NULL


SELECT * FROM POPULATIONVACCINATED

